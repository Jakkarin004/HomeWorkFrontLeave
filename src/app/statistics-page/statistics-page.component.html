<div class="main-static">
    <div class="main-body">
        <h2>สถิติการลาประจำเดือน</h2>
        <small>ข้อมูลการลาของพนักงานทั้งหมด</small>
    </div>
    <div class="">
        <button class="button-excel" (click)="exportToExcel()">
            Export Excel
        </button>
    </div>
</div>

<div class="filter-row">
    <!-- <mat-form-field>
        <mat-label>Choose a date</mat-label> 
        <input matInput [matDatepicker]="picker" [(ngModel)]="selectMonth" (dateChange)="applyFilter()">
        <mat-hint>MM/DD/YYYY</mat-hint> 
        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
    </mat-form-field> -->

    <mat-form-field appearance="outline">
        <mat-label>แผนก</mat-label>
        <mat-select (selectionChange)="applyFilter()" [(value)]="selectDepartment">
            <mat-option value="all">แผนกทั้งหมด</mat-option>
            <mat-option *ngFor="let dd of dataDepart" [value]="dd.department">{{dd.department}}</mat-option>
        </mat-select>

    </mat-form-field>
</div>

<div id="leaveChart" style="width: 95%; height: 400px;"></div>

 <h3>รายละเอียดการลารายบุคคล</h3>
<table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
    <ng-container matColumnDef="username">
        <th mat-header-cell *matHeaderCellDef>ชื่อ - นามสกุล</th>
        <td mat-cell *matCellDef="let data">{{ data.username }}</td>
    </ng-container>

    <ng-container matColumnDef="department">
        <th mat-header-cell *matHeaderCellDef>แผนก</th>
        <td mat-cell *matCellDef="let data">{{ data.department }}</td>
    </ng-container>

    <ng-container matColumnDef="leaveSick">
        <th mat-header-cell *matHeaderCellDef>ลาป่วย</th>
        <td mat-cell *matCellDef="let data">{{ data.leaveSick }}</td>
    </ng-container>

    <ng-container matColumnDef="leaveVa">
        <th mat-header-cell *matHeaderCellDef>ลาพักร้อน</th>
        <td mat-cell *matCellDef="let data">{{ data.leaveVa }}</td>
    </ng-container>

    <ng-container matColumnDef="leavePer">
        <th mat-header-cell *matHeaderCellDef>ลากิจ</th>
        <td mat-cell *matCellDef="let data">{{ data.leavePer }}</td>
    </ng-container>

    <ng-container matColumnDef="leaveTotal">
        <th mat-header-cell *matHeaderCellDef>รวม</th>
        <td mat-cell *matCellDef="let data">{{ data.leaveTotal }}</td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="dataName"></tr>
    <tr mat-row *matRowDef="let data; columns: dataName;"></tr>
</table>